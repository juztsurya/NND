import tensorflow as tf
from tensorflow.keras.datasets import mnist
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense, Flatten
import matplotlib.pyplot as plt
(x_train,y_train),(x_test,y_test)=mnist.load_data()  # Loads MNIST dataset
x_train=x_train/255.0
x_test=x_test/255.0
# Builds stacked neural network
model=Sequential([
    Flatten(input_shape=(28,28)),
    Dense(128,activation='relu'),
    Dense(10,activation='softmax') 
])
model.compile(optimizer='adam',loss='sparse_categorical_crossentropy',metrics=['accuracy']) # Configures training
model.fit(x_train,y_train,epochs=5)  # Trains model
model.evaluate(x_test,y_test)  # Tests model accuracy
pred=model.predict(x_test)   #Gets predictions
plt.imshow(x_test[0],cmap='gray')  #Displays image
plt.title("Predicted: "+str(pred[0].argmax()))
plt.axis('off')
plt.show()
